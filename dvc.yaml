stages:
  get_preprint_data_medrxiv:
    cmd: python preprint_revisions/get_preprint_data.py --start_date 2020-01-01 --end_date 2022-10-31 --filename "extracted_medrxiv.json" --server "medrxiv"
    deps:
    - preprint_revisions/get_preprint_data.py
    outs:
    - data/extracted_medrxiv.json

  get_preprint_data_biorxiv:
    cmd: python preprint_revisions/get_preprint_data.py --start_date 2020-01-01 --end_date 2022-10-31 --filename "extracted_biorxiv.json" --server "biorxiv"
    deps:
    - preprint_revisions/get_preprint_data.py
    outs:
    - data/extracted_biorxiv.json
    
  get_revisions_medrxiv:
    cmd: python preprint_revisions/get_revisions.py --server "medrxiv"
    deps: 
    - preprint_revisions/get_revisions.py
    - data/extracted_medrxiv.json
    - data/medrxiv_urls.json
    outs:
    - data/revision_dict_medrxiv.json

  get_revisions_biorxiv:
    cmd: python preprint_revisions/get_revisions.py --server "biorxiv"
    deps: 
    - preprint_revisions/get_revisions.py
    - data/extracted_biorxiv.json
    - data/biorxiv_urls.json
    outs:
    - data/revision_dict_biorxiv.json

  get_revision_times_medrxiv:
    cmd: python preprint_revisions/revision_time.py --server "medrxiv"
    deps: 
    - preprint_revisions/revision_time.py
    - data/extracted_medrxiv.json
    outs:
    - results/proportion_revisions_medrxiv.png
    - results/revisions_over_time_medrxiv.png
    - results/revision_times_medrxiv.png
    - results/number_of_revisions_medrxiv.png
    - results/revision_times_medrxiv_most_revised.png
    - results/revision_traces_medrxiv.json

  get_revision_times_biorxiv:
    cmd: python preprint_revisions/revision_time.py --server "biorxiv"
    deps: 
    - preprint_revisions/revision_time.py
    - data/extracted_biorxiv.json
    outs:
    - results/proportion_revisions_biorxiv.png
    - results/revisions_over_time_biorxiv.png
    - results/revision_times_biorxiv.png
    - results/number_of_revisions_biorxiv.png
    - results/revision_times_biorxiv_most_revised.png
    - results/revision_traces_biorxiv.json

  get_revision_stats_medrxiv:
    cmd: python preprint_revisions/revision_text_statistics.py --server "medrxiv"
    deps: 
    - preprint_revisions/revision_text_statistics.py
    - data/revision_dict_medrxiv.json
    - data/extracted_medrxiv.json
    outs:
    - results/proportion_revisions_with_text_medrxiv.png
    - results/revision_text_statistics_medrxiv.png
    - data/merged_df_medrxiv.csv

  get_revision_stats_biorxiv:
    cmd: python preprint_revisions/revision_text_statistics.py --server "biorxiv"
    deps: 
    - preprint_revisions/revision_text_statistics.py
    - data/revision_dict_biorxiv.json
    - data/extracted_biorxiv.json
    outs:
    - results/proportion_revisions_with_text_biorxiv.png
    - results/revision_text_statistics_biorxiv.png
    - data/merged_df_biorxiv.csv

  cluster_medrxiv:
    cmd: python preprint_revisions/cluster.py --server "medrxiv"
    deps:
    - preprint_revisions/cluster.py
    - data/revision_dict_medrxiv.json
    outs:
    - data/clusters_medrxiv.png
    - data/cluster_dict_medrxiv.json

  cluster_biorxiv:
    cmd: python preprint_revisions/cluster.py --server "biorxiv"
    deps:
    - preprint_revisions/cluster.py
    - data/revision_dict_biorxiv.json
    outs:
    - data/clusters_biorxiv.png
    - data/cluster_dict_biorxiv.json